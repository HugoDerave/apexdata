<% is_active = is_active || false %>

<div class="item-columns__content" item-columns-target="<%= block_id %>" style="<%= "display: none" if !is_active %>">
  <nav class="item-columns__center">
    <% items.each do |item| %>
      <div class="item-columns__item"
        data-action="item-columns-change-details"
        data-columns-data="<%= item.to_json %>"
        data-icon-source="<%= image_url "weapons/icons/#{ item["name"].downcase.gsub(" ", "_") }.png" %>">
        <div class="item-columns__item-name">
          <%= item["name"] %>
        </div>

        <% image_path = asset_exists?("weapons/#{ item["name"].downcase.gsub(" ", "_") }.jpg") ? "#{ item["name"].downcase.gsub(" ", "_") }" : "placeholder" %>

        <div class="item-columns__item-background">
          <picture>
            <source srcset="<%= image_url "weapons/webp/#{ image_path }.webp" %>" type="image/webp">
            <source srcset="<%= image_url "weapons/#{ image_path }.jpg" %>" type="image/jpeg">
            <%= image_tag "weapons/#{ image_path }.jpg", class: "item__image", alt: item["name"].humanize %>
          </picture>
        </div>
      </div>
    <% end %>
  </nav>

  <article class="item-columns__detail" data-role="item-columns-details">
    <div class="item-columns__detail-title">
      <h3 data-role="static-value" data-target="name"></h3>
      <img src="" data-role="item-columns-detail-icon" />
    </div>

    <div class="item-columns__radial-graphs">
      <%= render "pages/item_columns/radial_graph", target: "damage", label: "Damage", max: get_max_value(items, "damage") %>
      <%= render "pages/item_columns/radial_graph", target: "rate_of_fire", label: "RPM", max: get_max_value(items, "rate_of_fire") %>
    </div>

    <%= render "pages/item_columns/bar_graph", target: "damage_per_second", label: "Damage per second", max: get_max_value(items, "damage_per_second") %>
    <%= render "pages/item_columns/bar_graph", target: "headshot_damage", label: "Headshot damage", max: get_max_value(items, "headshot_damage") %>
    <%= render "pages/item_columns/bar_graph", target: "legshot_damage", label: "Legshot damage", max: get_max_value(items, "legshot_damage") %>
    <%= render "pages/item_columns/bar_graph", target: "damage_per_magazine", label: "Damage per mag", max: get_max_value(items, "damage_per_magazine") %>

    <hr>

    <%= render "pages/item_columns/static_value", target: "ammo_capacity", label: "Ammo capacity" %>
    <%= render "pages/item_columns/static_value", target: "projectile_speed", label: "Projectile speed", identifier: "m/s" %>
    <%= render "pages/item_columns/static_value", target: "tactical_reload", label: "Tactical reload", identifier: "s" %>
    <%= render "pages/item_columns/static_value", target: "empty_reload", label: "Empty reload", identifier: "s" %>
    <%= render "pages/item_columns/static_value", target: "draw_time", label: "Draw time", identifier: "s" %>
    <%= render "pages/item_columns/static_value", target: "holster_time", label: "Holster time", identifier: "s" %>
  </article>
</div>
