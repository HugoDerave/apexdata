<% notifications = current_user.notifications.where.not(has_been_read: 1) %>

if (document.querySelector(".notifications__content").classList.contains("notifications__content--is-active")) {
  document.querySelector("[data-role='notifications']").innerHTML = `
    <% if notifications.any? %>
      <% notifications.each do |notification| %>
        <div class="notifications__item">
          <%= notification.content %>
          <%= link_to "View", notification.go_to, class: "notifications__item-action" if notification.go_to.present? %>
        </div>

        <% notification.update!(has_been_read: 1) %>
      <% end %>
    <% else %>
      <div class="notifications__item">
        You have no new notifications.
      </div>
    <% end %>
  `
} else {
  document.querySelector("[data-role='notifications']").innerHTML = ""
}
